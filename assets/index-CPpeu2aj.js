var Ee=Object.defineProperty;var Pe=(t,e,r)=>e in t?Ee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var F=(t,e,r)=>Pe(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=r(o);fetch(o.href,l)}})();function v(){}function ge(t){return t()}function le(){return Object.create(null)}function H(t){t.forEach(ge)}function pe(t){return typeof t=="function"}function j(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let T;function B(t,e){return t===e?!0:(T||(T=document.createElement("a")),T.href=e,t===T.href)}function Se(t){return Object.keys(t).length===0}function V(t,e){t.appendChild(e)}function $(t,e,r){t.insertBefore(e,r||null)}function p(t){t.parentNode&&t.parentNode.removeChild(t)}function _e(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function E(t){return document.createElement(t)}function Z(t){return document.createTextNode(t)}function be(){return Z(" ")}function Me(){return Z("")}function f(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function Ie(t){return Array.from(t.childNodes)}function ke(t,e){e=""+e,t.data!==e&&(t.data=e)}function W(t,e,r,n){r==null?t.style.removeProperty(e):t.style.setProperty(e,r,"")}function Le(t,e,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:n})}let A;function x(t){A=t}function ee(){if(!A)throw new Error("Function called outside component initialization");return A}function te(t){ee().$$.on_mount.push(t)}function Ne(t){ee().$$.on_destroy.push(t)}function Ce(){const t=ee();return(e,r,{cancelable:n=!1}={})=>{const o=t.$$.callbacks[e];if(o){const l=Le(e,r,{cancelable:n});return o.slice().forEach(i=>{i.call(t,l)}),!l.defaultPrevented}return!0}}const N=[],se=[];let C=[];const ce=[],xe=Promise.resolve();let J=!1;function Ae(){J||(J=!0,xe.then(we))}function Q(t){C.push(t)}const G=new Set;let L=0;function we(){if(L!==0)return;const t=A;do{try{for(;L<N.length;){const e=N[L];L++,x(e),He(e.$$)}}catch(e){throw N.length=0,L=0,e}for(x(null),N.length=0,L=0;se.length;)se.pop()();for(let e=0;e<C.length;e+=1){const r=C[e];G.has(r)||(G.add(r),r())}C.length=0}while(N.length);for(;ce.length;)ce.pop()();J=!1,G.clear(),x(t)}function He(t){if(t.fragment!==null){t.update(),H(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Q)}}function Re(t){const e=[],r=[];C.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),C=e}const O=new Set;let I;function ne(){I={r:0,c:[],p:I}}function re(){I.r||H(I.c),I=I.p}function g(t,e){t&&t.i&&(O.delete(t),t.i(e))}function P(t,e,r,n){if(t&&t.o){if(O.has(t))return;O.add(t),I.c.push(()=>{O.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function X(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function oe(t){t&&t.c()}function Y(t,e,r){const{fragment:n,after_update:o}=t.$$;n&&n.m(e,r),Q(()=>{const l=t.$$.on_mount.map(ge).filter(pe);t.$$.on_destroy?t.$$.on_destroy.push(...l):H(l),t.$$.on_mount=[]}),o.forEach(Q)}function q(t,e){const r=t.$$;r.fragment!==null&&(Re(r.after_update),H(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Te(t,e){t.$$.dirty[0]===-1&&(N.push(t),Ae(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function U(t,e,r,n,o,l,i=null,u=[-1]){const s=A;x(t);const c=t.$$={fragment:null,ctx:[],props:l,update:v,not_equal:o,bound:le(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:le(),dirty:u,skip_bound:!1,root:e.target||s.$$.root};i&&i(c.root);let m=!1;if(c.ctx=r?r(t,e.props||{},(a,d,..._)=>{const b=_.length?_[0]:d;return c.ctx&&o(c.ctx[a],c.ctx[a]=b)&&(!c.skip_bound&&c.bound[a]&&c.bound[a](b),m&&Te(t,a)),d}):[],c.update(),m=!0,H(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const a=Ie(e.target);c.fragment&&c.fragment.l(a),a.forEach(p)}else c.fragment&&c.fragment.c();e.intro&&g(t.$$.fragment),Y(t,e.target,e.anchor),we()}x(s)}class z{constructor(){F(this,"$$");F(this,"$$set")}$destroy(){q(this,1),this.$destroy=v}$on(e,r){if(!pe(r))return v;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const o=n.indexOf(r);o!==-1&&n.splice(o,1)}}$set(e){this.$$set&&!Se(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const We="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(We);function $e(t){return t<=600}function ue(t,e,r){const n=t.slice();return n[8]=e[r],n}function ae(t){let e,r,n,o,l,i,u;return{c(){e=E("a"),r=E("img"),l=be(),f(r,"class","thumbnail svelte-8ifd7i"),B(r.src,n=t[8].url)||f(r,"src",n),f(r,"alt",o="img "+t[8].id),f(e,"id",i=`thumbnail-${t[8].id}`),f(e,"href",u=t[8].url),f(e,"class","thumbnail-wrapper svelte-8ifd7i"),W(e,"left",t[8].posX+"px"),W(e,"top",t[8].posY+"px")},m(s,c){$(s,e,c),V(e,r),V(e,l)},p(s,c){c&1&&!B(r.src,n=s[8].url)&&f(r,"src",n),c&1&&o!==(o="img "+s[8].id)&&f(r,"alt",o),c&1&&i!==(i=`thumbnail-${s[8].id}`)&&f(e,"id",i),c&1&&u!==(u=s[8].url)&&f(e,"href",u),c&1&&W(e,"left",s[8].posX+"px"),c&1&&W(e,"top",s[8].posY+"px")},d(s){s&&p(e)}}}function Oe(t){let e,r=X(t[0]),n=[];for(let o=0;o<r.length;o+=1)n[o]=ae(ue(t,r,o));return{c(){e=E("div");for(let o=0;o<n.length;o+=1)n[o].c()},m(o,l){$(o,e,l);for(let i=0;i<n.length;i+=1)n[i]&&n[i].m(e,null)},p(o,[l]){if(l&1){r=X(o[0]);let i;for(i=0;i<r.length;i+=1){const u=ue(o,r,i);n[i]?n[i].p(u,l):(n[i]=ae(u),n[i].c(),n[i].m(e,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=r.length}},i:v,o:v,d(o){o&&p(e),_e(n,o)}}}const M=30;function Be(t,e,r,n,o,l){return!(t+(o+M)<=r||r+(o+M)<=t||e+(l+M)<=n||n+(l+M)<=e)}function Xe(){const t=document.querySelector(".thumbnail");if(!t)return{tMaxWidth:100,tMaxHeight:100};const e=window.getComputedStyle(t),r=parseInt(e.maxWidth)||100,n=parseInt(e.maxHeight)||100;return{tMaxWidth:r,tMaxHeight:n}}function je(t,e,r){let{pageNumber:n}=e,{pageHeight:o}=e,{pageWidth:l}=e,{thumbnails:i=[]}=e;const u=Ce();te(async()=>{r(0,i=c()),u("pageRendered",{thumbnailCount:i.length})});function s(){let a=M,d=M;return n==0?{topStart:d,leftStart:a}:($e(l)?d+=n*o:a+=n*l,{topStart:d,leftStart:a})}function c(){const d=[],_=[],{tMaxWidth:b,tMaxHeight:k}=Xe(),{topStart:h,leftStart:w}=s();return i.forEach(y=>{let S,R,ie;const D=document.getElementById(`thumbnail-${y.id}`);if(!D)throw new Error(`Cannot find elem thumbnail-${y.id} to set randomised position.`);let K=0;do({posX:S,posY:R}=m(w,h,k,b)),ie=d.some(({posX:ye,posY:ve})=>Be(S,R,ye,ve,b,k)),K++;while(ie&&K<50);d.push({element:D,posX:S,posY:R}),K>=50&&(console.warn(`Skipping thumbnail ${y.id} due to space constraints.`),D.style.display="none"),_.push({...y,posX:S,posY:R})}),_}function m(a,d,_,b){let k=d+o-M-_,h=a+l-M-b;return{posX:Math.floor(Math.random()*(h-a)+a),posY:Math.floor(Math.random()*(k-d)+d)}}return t.$$set=a=>{"pageNumber"in a&&r(1,n=a.pageNumber),"pageHeight"in a&&r(2,o=a.pageHeight),"pageWidth"in a&&r(3,l=a.pageWidth),"thumbnails"in a&&r(0,i=a.thumbnails)},[i,n,o,l]}class Ye extends z{constructor(e){super(),U(this,e,je,Oe,j,{pageNumber:1,pageHeight:2,pageWidth:3,thumbnails:0})}}function fe(t,e,r){const n=t.slice();return n[1]=e[r].thumbnails,n[14]=r,n}function de(t){let e,r,n=X(t[0]),o=[];for(let i=0;i<n.length;i+=1)o[i]=he(fe(t,n,i));const l=i=>P(o[i],1,1,()=>{o[i]=null});return{c(){for(let i=0;i<o.length;i+=1)o[i].c();e=Me()},m(i,u){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(i,u);$(i,e,u),r=!0},p(i,u){if(u&29){n=X(i[0]);let s;for(s=0;s<n.length;s+=1){const c=fe(i,n,s);o[s]?(o[s].p(c,u),g(o[s],1)):(o[s]=he(c),o[s].c(),g(o[s],1),o[s].m(e.parentNode,e))}for(ne(),s=n.length;s<o.length;s+=1)l(s);re()}},i(i){if(!r){for(let u=0;u<n.length;u+=1)g(o[u]);r=!0}},o(i){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)P(o[u]);r=!1},d(i){i&&p(e),_e(o,i)}}}function he(t){let e,r;return e=new Ye({props:{thumbnails:t[1],pageNumber:t[14],pageHeight:t[3],pageWidth:t[2]}}),e.$on("pageRendered",t[4]),{c(){oe(e.$$.fragment)},m(n,o){Y(e,n,o),r=!0},p(n,o){const l={};o&1&&(l.thumbnails=n[1]),e.$set(l)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){q(e,n)}}}function qe(t){let e,r,n=t[1].length&&de(t);return{c(){e=E("div"),n&&n.c(),f(e,"id","photos-wrapper"),f(e,"class","svelte-18731qk")},m(o,l){$(o,e,l),n&&n.m(e,null),r=!0},p(o,[l]){o[1].length?n?(n.p(o,l),l&2&&g(n,1)):(n=de(o),n.c(),g(n,1),n.m(e,null)):n&&(ne(),P(n,1,1,()=>{n=null}),re())},i(o){r||(g(n),r=!0)},o(o){P(n),r=!1},d(o){o&&p(e),n&&n.d()}}}const me=5,Ue="http://localhost:8080/api/photos-blog/thumbnails";function ze(t,e,r){const n=window.innerWidth,o=window.innerHeight;let l=[],i=0,u="",s=[],c=!1,m=!1;function a(h){i+=h.detail.thumbnailCount,_()}async function d(){if(c)return;c=!0;let w=2*me;await k(w),_(),c=!1}function _(){if(i>=s.length)return;const h=s.slice(i,i+me);i++,r(0,l=[...l,{pageStart:i,thumbnails:h}])}te(async()=>{await d(),window.addEventListener("scroll",b)}),Ne(()=>{window.removeEventListener("scroll",b)});function b(){let h=0,w=0;$e(n)?(h=window.scrollY+window.innerHeight,w=l.length*o-o):(h=window.scrollX+window.innerWidth,w=l.length*n-n),console.log("should scroll"),console.log(h>=w),h>=w&&d()}async function k(h){if(m)return;const w=`${Ue}?folder=photos-blog&limit=${h}&startKey=${u}`;try{let S=await(await fetch(w)).json();r(1,s=[...s,...S.images]),u=S.nextPageStart,S.nextPageStart===""&&(console.log("All thumbnails loaded, total: "+s.length),m=!0)}catch(y){console.error("Error loading thumbnails:",y)}}return[l,s,n,o,a]}class De extends z{constructor(e){super(),U(this,e,ze,qe,j,{})}}function Ke(t){let e;return{c(){e=E("div"),e.textContent="wip photo preview"},m(r,n){$(r,e,n)},p:v,d(r){r&&p(e)}}}function Fe(t){let e,r=t[0].title+"",n,o,l,i,u;return{c(){e=E("h1"),n=Z(r),o=be(),l=E("img"),B(l.src,i=t[0].url)||f(l,"src",i),f(l,"alt",u=t[0].title)},m(s,c){$(s,e,c),V(e,n),$(s,o,c),$(s,l,c)},p(s,c){c&1&&r!==(r=s[0].title+"")&&ke(n,r),c&1&&!B(l.src,i=s[0].url)&&f(l,"src",i),c&1&&u!==(u=s[0].title)&&f(l,"alt",u)},d(s){s&&(p(e),p(o),p(l))}}}function Ge(t){let e;function r(l,i){return l[0]?Fe:Ke}let n=r(t),o=n(t);return{c(){e=E("div"),o.c()},m(l,i){$(l,e,i),o.m(e,null)},p(l,[i]){n===(n=r(l))&&o?o.p(l,i):(o.d(1),o=n(l),o&&(o.c(),o.m(e,null)))},i:v,o:v,d(l){l&&p(e),o.d()}}}function Ve(t,e,r){let{id:n}=e,o;return te(async()=>{if(!o){const l=await fetch(`/api/photos/${n}`);r(0,o=await l.json())}}),t.$$set=l=>{"id"in l&&r(1,n=l.id)},[o,n]}class Je extends z{constructor(e){super(),U(this,e,Ve,Ge,j,{id:1})}}function Qe(t){let e,r;return e=new De({}),{c(){oe(e.$$.fragment)},m(n,o){Y(e,n,o),r=!0},p:v,i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){q(e,n)}}}function Ze(t){let e,r;return e=new Je({props:{id:t[0]}}),{c(){oe(e.$$.fragment)},m(n,o){Y(e,n,o),r=!0},p(n,o){const l={};o&1&&(l.id=n[0]),e.$set(l)},i(n){r||(g(e.$$.fragment,n),r=!0)},o(n){P(e.$$.fragment,n),r=!1},d(n){q(e,n)}}}function et(t){let e,r,n,o;const l=[Ze,Qe],i=[];function u(s,c){var m;return(m=s[0])!=null&&m.length?0:1}return r=u(t),n=i[r]=l[r](t),{c(){e=E("main"),n.c(),f(e,"class","svelte-1tyzdic")},m(s,c){$(s,e,c),i[r].m(e,null),o=!0},p(s,[c]){let m=r;r=u(s),r===m?i[r].p(s,c):(ne(),P(i[m],1,1,()=>{i[m]=null}),re(),n=i[r],n?n.p(s,c):(n=i[r]=l[r](s),n.c()),g(n,1),n.m(e,null))},i(s){o||(g(n),o=!0)},o(s){P(n),o=!1},d(s){s&&p(e),i[r].d()}}}function tt(t,e,r){let{photoIdParam:n=null}=e;addEventListener("DOMContentLoaded",()=>{const u=new URLSearchParams(window.location.search);r(0,n=u.get("photo")),o()});function o(){const u=document.getElementsByTagName("body")[0],s=i();u.style.backgroundColor=s}const l=new Map([["light","#f7ed9c"],["dark","#363d51"]]);function i(){let u=localStorage.getItem("theme");return u||(u="light"),l.get(u)}return t.$$set=u=>{"photoIdParam"in u&&r(0,n=u.photoIdParam)},[n]}class nt extends z{constructor(e){super(),U(this,e,tt,et,j,{photoIdParam:0})}}new nt({target:document.getElementById("app")});
