var ue=Object.defineProperty;var ce=(t,e,n)=>e in t?ue(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var x=(t,e,n)=>ce(t,typeof e!="symbol"?e+"":e,n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();function p(){}function ee(t){return t()}function z(){return Object.create(null)}function T(t){t.forEach(ee)}function te(t){return typeof t=="function"}function O(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let k;function N(t,e){return t===e?!0:(k||(k=document.createElement("a")),k.href=e,t===k.href)}function fe(t){return Object.keys(t).length===0}function j(t,e){t.appendChild(e)}function g(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function ae(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function ne(t){return document.createTextNode(t)}function re(){return ne(" ")}function d(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function de(t){return Array.from(t.childNodes)}function he(t,e){e=""+e,t.data!==e&&(t.data=e)}function C(t,e,n,r){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}let I;function A(t){I=t}function pe(){if(!I)throw new Error("Function called outside component initialization");return I}function oe(t){pe().$$.on_mount.push(t)}const v=[],G=[];let E=[];const J=[],me=Promise.resolve();let D=!1;function _e(){D||(D=!0,me.then(ie))}function q(t){E.push(t)}const R=new Set;let y=0;function ie(){if(y!==0)return;const t=I;do{try{for(;y<v.length;){const e=v[y];y++,A(e),ge(e.$$)}}catch(e){throw v.length=0,y=0,e}for(A(null),v.length=0,y=0;G.length;)G.pop()();for(let e=0;e<E.length;e+=1){const n=E[e];R.has(n)||(R.add(n),n())}E.length=0}while(v.length);for(;J.length;)J.pop()();D=!1,R.clear(),A(t)}function ge(t){if(t.fragment!==null){t.update(),T(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(q)}}function be(t){const e=[],n=[];E.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),E=e}const S=new Set;let w;function $e(){w={r:0,c:[],p:w}}function we(){w.r||T(w.c),w=w.p}function M(t,e){t&&t.i&&(S.delete(t),t.i(e))}function P(t,e,n,r){if(t&&t.o){if(S.has(t))return;S.add(t),w.c.push(()=>{S.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function K(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function F(t){t&&t.c()}function L(t,e,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,n),q(()=>{const i=t.$$.on_mount.map(ee).filter(te);t.$$.on_destroy?t.$$.on_destroy.push(...i):T(i),t.$$.on_mount=[]}),o.forEach(q)}function H(t,e){const n=t.$$;n.fragment!==null&&(be(n.after_update),T(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ye(t,e){t.$$.dirty[0]===-1&&(v.push(t),_e(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function B(t,e,n,r,o,i,l=null,c=[-1]){const s=I;A(t);const u=t.$$={fragment:null,ctx:[],props:i,update:p,not_equal:o,bound:z(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:z(),dirty:c,skip_bound:!1,root:e.target||s.$$.root};l&&l(u.root);let f=!1;if(u.ctx=n?n(t,e.props||{},(a,m,..._)=>{const $=_.length?_[0]:m;return u.ctx&&o(u.ctx[a],u.ctx[a]=$)&&(!u.skip_bound&&u.bound[a]&&u.bound[a]($),f&&ye(t,a)),m}):[],u.update(),f=!0,T(u.before_update),u.fragment=r?r(u.ctx):!1,e.target){if(e.hydrate){const a=de(e.target);u.fragment&&u.fragment.l(a),a.forEach(h)}else u.fragment&&u.fragment.c();e.intro&&M(t.$$.fragment),L(t,e.target,e.anchor),ie()}A(s)}class X{constructor(){x(this,"$$");x(this,"$$set")}$destroy(){H(this,1),this.$destroy=p}$on(e,n){if(!te(n))return p;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const o=r.indexOf(n);o!==-1&&r.splice(o,1)}}$set(e){this.$$set&&!fe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ve="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ve);function V(t,e,n){const r=t.slice();return r[4]=e[n],r}function Q(t){let e,n,r,o,i,l,c;return{c(){e=b("a"),n=b("img"),i=re(),d(n,"class","thumbnail svelte-buvq0y"),N(n.src,r=t[4].url)||d(n,"src",r),d(n,"alt",o="Thumbnail "+t[4].id),d(e,"id",l=`thumbnail-${t[4].id}`),d(e,"href",c=t[4].url),d(e,"class","thumbnail-wrapper svelte-buvq0y"),C(e,"left",t[4].posX+"px"),C(e,"top",t[4].posY+"px")},m(s,u){g(s,e,u),j(e,n),j(e,i)},p(s,u){u&1&&!N(n.src,r=s[4].url)&&d(n,"src",r),u&1&&o!==(o="Thumbnail "+s[4].id)&&d(n,"alt",o),u&1&&l!==(l=`thumbnail-${s[4].id}`)&&d(e,"id",l),u&1&&c!==(c=s[4].url)&&d(e,"href",c),u&1&&C(e,"left",s[4].posX+"px"),u&1&&C(e,"top",s[4].posY+"px")},d(s){s&&h(e)}}}function Ee(t){let e,n=K(t[0]),r=[];for(let o=0;o<n.length;o+=1)r[o]=Q(V(t,n,o));return{c(){e=b("div");for(let o=0;o<r.length;o+=1)r[o].c()},m(o,i){g(o,e,i);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(o,[i]){if(i&1){n=K(o[0]);let l;for(l=0;l<n.length;l+=1){const c=V(o,n,l);r[l]?r[l].p(c,i):(r[l]=Q(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},i:p,o:p,d(o){o&&h(e),ae(r,o)}}}const Me=5,Ae=250,Ie=250,Z=30;function Pe(t,e){return{posX:Math.floor(Math.random()*t),posY:Math.floor(Math.random()*e)}}function Te(t,e,n,r){const o=Ae+Z,i=Ie+Z;return!(t+o<=n||n+o<=t||e+i<=r||r+i<=e)}function ke(t,e,n){let{pageStart:r}=e,o=[];oe(async()=>{await i(r,Me),n(0,o=l())});async function i(c,s){const u="https://rkimmiblogserver.fly.dev/api/photos-blog/thumbnails";try{let a=await(await fetch(u)).json();n(0,o=a.images.splice(0,s))}catch(f){console.error("Error loading thumbnails:",f)}}function l(){const s=window.innerWidth-250,u=window.innerHeight-250,f=[],a=[];return o.forEach(m=>{let _,$,U;const Y=document.getElementById(`thumbnail-${m.id}`);if(!Y)throw new Error(`Cannot find elem thumbnail-${m.id} to set randomised position.`);let W=0;do({posX:_,posY:$}=Pe(s,u)),U=f.some(({posX:le,posY:se})=>Te(_,$,le,se)),W++;while(U);if(f.push({element:Y,posX:_,posY:$}),W>=50){console.warn(`Skipping thumbnail ${m.id} due to space constraints.`);return}a.push({...m,posX:_,posY:$})}),a}return t.$$set=c=>{"pageStart"in c&&n(1,r=c.pageStart)},[o,r]}class Ce extends X{constructor(e){super(),B(this,e,ke,Ee,O,{pageStart:1})}}function Se(t){let e,n,r;return n=new Ce({props:{pageStart:0}}),{c(){e=b("div"),F(n.$$.fragment)},m(o,i){g(o,e,i),L(n,e,null),r=!0},p,i(o){r||(M(n.$$.fragment,o),r=!0)},o(o){P(n.$$.fragment,o),r=!1},d(o){o&&h(e),H(n)}}}class Ne extends X{constructor(e){super(),B(this,e,null,Se,O,{})}}function Oe(t){let e;return{c(){e=b("div"),e.textContent="wip photo preview"},m(n,r){g(n,e,r)},p,d(n){n&&h(e)}}}function Le(t){let e,n=t[0].title+"",r,o,i,l,c;return{c(){e=b("h1"),r=ne(n),o=re(),i=b("img"),N(i.src,l=t[0].url)||d(i,"src",l),d(i,"alt",c=t[0].title)},m(s,u){g(s,e,u),j(e,r),g(s,o,u),g(s,i,u)},p(s,u){u&1&&n!==(n=s[0].title+"")&&he(r,n),u&1&&!N(i.src,l=s[0].url)&&d(i,"src",l),u&1&&c!==(c=s[0].title)&&d(i,"alt",c)},d(s){s&&(h(e),h(o),h(i))}}}function He(t){let e;function n(i,l){return i[0]?Le:Oe}let r=n(t),o=r(t);return{c(){e=b("div"),o.c()},m(i,l){g(i,e,l),o.m(e,null)},p(i,[l]){r===(r=n(i))&&o?o.p(i,l):(o.d(1),o=r(i),o&&(o.c(),o.m(e,null)))},i:p,o:p,d(i){i&&h(e),o.d()}}}function Be(t,e,n){let{id:r}=e,o;return oe(async()=>{if(!o){const i=await fetch(`/api/photos/${r}`);n(0,o=await i.json())}}),t.$$set=i=>{"id"in i&&n(1,r=i.id)},[o,r]}class Xe extends X{constructor(e){super(),B(this,e,Be,He,O,{id:1})}}function xe(t){let e,n;return e=new Ne({}),{c(){F(e.$$.fragment)},m(r,o){L(e,r,o),n=!0},p,i(r){n||(M(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function Re(t){let e,n;return e=new Xe({props:{id:t[0]}}),{c(){F(e.$$.fragment)},m(r,o){L(e,r,o),n=!0},p(r,o){const i={};o&1&&(i.id=r[0]),e.$set(i)},i(r){n||(M(e.$$.fragment,r),n=!0)},o(r){P(e.$$.fragment,r),n=!1},d(r){H(e,r)}}}function je(t){let e,n,r,o;const i=[Re,xe],l=[];function c(s,u){var f;return(f=s[0])!=null&&f.length?0:1}return n=c(t),r=l[n]=i[n](t),{c(){e=b("main"),r.c(),d(e,"class","svelte-1tyzdic")},m(s,u){g(s,e,u),l[n].m(e,null),o=!0},p(s,[u]){let f=n;n=c(s),n===f?l[n].p(s,u):($e(),P(l[f],1,1,()=>{l[f]=null}),we(),r=l[n],r?r.p(s,u):(r=l[n]=i[n](s),r.c()),M(r,1),r.m(e,null))},i(s){o||(M(r),o=!0)},o(s){P(r),o=!1},d(s){s&&h(e),l[n].d()}}}function De(t,e,n){let{url:r=""}=e,{photoIdParam:o=null}=e;addEventListener("DOMContentLoaded",()=>{const c=new URLSearchParams(window.location.search);n(0,o=c.get("photo"));const s=document.getElementsByTagName("body")[0],[u,f]=l();s.style.backgroundColor=u,s.style.color=f});const i=new Map([[0,["#bd1818","white"]],[12,["#ffffaa","brown"]],[16,["#18BD70","black"]],[20,["#A7A7F3","white"]]]);function l(){let c="",s="";const f=new Date().getHours();for(let[a,[m,_]]of i)if(f>=a)c=m,s=_;else break;return[c,s]}return t.$$set=c=>{"url"in c&&n(1,r=c.url),"photoIdParam"in c&&n(0,o=c.photoIdParam)},[o,r]}class qe extends X{constructor(e){super(),B(this,e,De,je,O,{url:1,photoIdParam:0})}}new qe({target:document.getElementById("app")});
